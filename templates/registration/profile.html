{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Profile - ResuStack</title>
    <meta name="description" content="Manage your ResuStack account settings."/>
    
    <!-- Google Fonts: Inter & Material Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet"/>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        "primary": "#2563eb",
                        "primary-hover": "#1d4ed8",
                        "background-light": "#f1f5f9",
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"],
                        "sans": ["Inter", "sans-serif"]
                    },
                },
            },
        }
    </script>
    
    <style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>

<body class="bg-background-light min-h-screen flex flex-col font-display">
    <!-- Header -->
    <header class="flex items-center justify-between whitespace-nowrap border-b border-slate-200 bg-white px-4 md:px-10 lg:px-20 py-4 z-10 sticky top-0">
        <a href="{% url 'resume:dashboard' %}" class="flex items-center gap-3">
            <img src="{% static 'img/resustack_logo.png' %}" alt="ResuStack Logo" class="h-8 w-auto object-contain"/>
            <h2 class="text-slate-900 text-2xl font-bold tracking-tight">ResuStack</h2>
        </a>
        
        <div class="flex flex-1 justify-end gap-8">
            <nav class="hidden md:flex items-center gap-6">
                <a class="text-slate-500 text-sm font-medium hover:text-primary transition-colors" href="{% url 'resume:dashboard' %}">Dashboard</a>
                <a class="text-primary text-sm font-semibold" href="{% url 'profile' %}">Profile</a>
            </nav>
            
            <div class="flex items-center gap-4">
                <div class="w-9 h-9 rounded-full bg-slate-200 flex items-center justify-center text-slate-600 font-bold border border-slate-300">
                    {{ user.username|slice:":1"|upper }}
                </div>
                <a href="{% url 'logout' %}" class="flex items-center gap-1 text-slate-500 text-sm font-medium hover:text-red-500 transition-colors">
                    <span class="material-symbols-outlined text-lg">logout</span>
                    <span class="hidden sm:inline">Logout</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 px-4 md:px-10 lg:px-20 py-10">
        <div class="max-w-2xl mx-auto">
            <!-- Page Title -->
            <div class="mb-8">
                <h1 class="text-2xl font-bold text-slate-900">Account Settings</h1>
                <p class="text-slate-500 mt-1">Manage your profile and security settings.</p>
            </div>

            <!-- Success Message -->
            {% if messages %}
            {% for message in messages %}
            <div class="mb-6 p-4 rounded-lg flex items-center gap-3 {% if message.tags == 'success' %}bg-green-50 border border-green-200 text-green-800{% else %}bg-red-50 border border-red-200 text-red-800{% endif %}">
                <span class="material-symbols-outlined">{% if message.tags == 'success' %}check_circle{% else %}error{% endif %}</span>
                <span class="text-sm font-medium">{{ message }}</span>
            </div>
            {% endfor %}
            {% endif %}

            <!-- Profile Info Card -->
            <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden mb-6">
                <div class="px-6 py-4 border-b border-slate-100 bg-slate-50">
                    <h2 class="font-semibold text-slate-900 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">person</span>
                        Profile Information
                    </h2>
                </div>
                <div class="p-6 space-y-5">
                    <!-- Username (Read-only) -->
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Username</label>
                        <div class="flex items-center gap-3">
                            <input 
                                type="text" 
                                value="{{ user.username }}" 
                                readonly
                                class="flex-1 px-4 py-2.5 bg-slate-100 border border-slate-200 rounded-lg text-slate-600 text-sm cursor-not-allowed"
                            />
                            <span class="text-xs text-slate-400 flex items-center gap-1">
                                <span class="material-symbols-outlined text-sm">lock</span>
                                Cannot be changed
                            </span>
                        </div>
                    </div>
                    
                    <!-- Email (Read-only) -->
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Email Address</label>
                        <div class="flex items-center gap-3">
                            <input 
                                type="email" 
                                value="{{ user.email|default:'Not set' }}" 
                                readonly
                                class="flex-1 px-4 py-2.5 bg-slate-100 border border-slate-200 rounded-lg text-slate-600 text-sm cursor-not-allowed"
                            />
                            <span class="text-xs text-slate-400 flex items-center gap-1">
                                <span class="material-symbols-outlined text-sm">lock</span>
                                Cannot be changed
                            </span>
                        </div>
                    </div>
                    
                    <!-- Member Since -->
                    <div>
                        <label class="block text-sm font-medium text-slate-700 mb-2">Member Since</label>
                        <p class="text-sm text-slate-600">{{ user.date_joined|date:"F j, Y" }}</p>
                    </div>
                </div>
            </div>

            <!-- Change Password Card -->
            <div class="bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden">
                <div class="px-6 py-4 border-b border-slate-100 bg-slate-50">
                    <h2 class="font-semibold text-slate-900 flex items-center gap-2">
                        <span class="material-symbols-outlined text-primary">key</span>
                        Change Password
                    </h2>
                </div>
                <div class="p-6">
                    <!-- Password Form Errors -->
                    {% if password_form.errors %}
                    <div class="mb-4 p-4 rounded-lg bg-red-50 border border-red-200">
                        <ul class="text-red-700 text-sm space-y-1">
                            {% for field in password_form %}
                                {% for error in field.errors %}
                                    <li class="flex items-center gap-2">
                                        <span class="material-symbols-outlined text-sm">error</span>
                                        {{ error }}
                                    </li>
                                {% endfor %}
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                    
                    <form method="post" class="space-y-5">
                        {% csrf_token %}
                        
                        <!-- Current Password -->
                        <div>
                            <label for="id_old_password" class="block text-sm font-medium text-slate-700 mb-2">Current Password</label>
                            <div class="relative">
                                <input 
                                    type="password" 
                                    name="old_password"
                                    id="id_old_password"
                                    class="w-full px-4 py-2.5 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all"
                                    placeholder="Enter your current password"
                                    required
                                />
                            </div>
                        </div>
                        
                        <!-- New Password -->
                        <div>
                            <label for="id_new_password1" class="block text-sm font-medium text-slate-700 mb-2">New Password</label>
                            <div class="relative">
                                <input 
                                    type="password" 
                                    name="new_password1"
                                    id="id_new_password1"
                                    class="w-full px-4 py-2.5 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all"
                                    placeholder="Enter your new password"
                                    required
                                />
                            </div>
                            <p class="text-xs text-slate-400 mt-1.5">At least 8 characters. Can't be too common or all numeric.</p>
                        </div>
                        
                        <!-- Confirm New Password -->
                        <div>
                            <label for="id_new_password2" class="block text-sm font-medium text-slate-700 mb-2">Confirm New Password</label>
                            <div class="relative">
                                <input 
                                    type="password" 
                                    name="new_password2"
                                    id="id_new_password2"
                                    class="w-full px-4 py-2.5 border border-slate-200 rounded-lg text-sm focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all"
                                    placeholder="Confirm your new password"
                                    required
                                />
                            </div>
                        </div>
                        
                        <!-- Submit Button -->
                        <div class="pt-2">
                            <button 
                                type="submit" 
                                class="w-full sm:w-auto px-6 py-2.5 bg-primary text-white font-semibold text-sm rounded-lg hover:bg-primary-hover transition-all shadow-md shadow-primary/20"
                            >
                                Update Password
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Back to Dashboard -->
            <div class="mt-8 text-center">
                <a href="{% url 'resume:dashboard' %}" class="text-sm text-slate-500 hover:text-primary transition-colors inline-flex items-center gap-1">
                    <span class="material-symbols-outlined text-lg">arrow_back</span>
                    Back to Dashboard
                </a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-auto border-t border-slate-200 bg-white py-8 px-4 md:px-10 lg:px-20">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4 max-w-[1200px] mx-auto w-full">
            <div class="flex items-center gap-2">
                <img src="{% static 'img/resustack_logo.png' %}" alt="Logo" class="w-4 h-4 object-contain grayscale opacity-50"/>
                <span class="text-sm font-bold tracking-tight text-slate-400">ResuStack</span>
            </div>
            <p class="text-slate-400 text-xs font-medium">Â© 2026 ResuStack. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
